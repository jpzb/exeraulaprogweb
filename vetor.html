<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Vetor dinâmico</title>
    <style>
        .tudo{
            position: absolute;
            left: 45%;
            top: 15%;
        }
        .barra{
            background-color: rgb(184, 184, 184);
            height: 20px;
            width: 200px;
        }
        .tudo2{
            position: absolute;
            left: 33%;
            top: 10%;
        }
        #insere{
            position: relative;
            left: 12%;
            width: 100px;
            height: 50px;
            background-color: rgb(141, 184, 231);
        }
        .select{
            background-color: rgb(184, 184, 184);
            height: 25px;
        }
        .barraPesquisa{
            background-color: rgb(184, 184, 184);
            height: 25px;
            width: 200px;
        }
    </style>
    <script>
    vnome = new Array();
    function registro(){
        this.nom = document.getElementById("name").value;
        this.tel = document.getElementById("tel").value;
        this.ema = document.getElementById("ema").value;
    }
    function lista(){
        aux = "";
        for (x=0; x<vnome.length; x++) {
            aux += '<tr><td>' +vnome[x].nom + "</td><td>" +vnome[x].tel +'</td><td>' +vnome[x].ema + '</td><td>' + '<a href="javascript:deletar()"> Excluir</a>' + '</td></tr>';
        } 
        document.getElementById("lista").innerHTML = ['<table border="5px" class="tabela">',
        '<thead bgcolor="gray">',
        '<tr>',
        '<th class="titulo">Nome</th>',
        '<th class="titulo">Telefone</th>',
        '<th class="titulo">E-mail</th>',
        '<th class="titulo">Excluir</th>',
        '</tr>',
        '</thead>',
        '<tbody>',
        aux,
        '</tbody>',
        '</table>'].join("\n")
    }
    function deletar(pos) {
        vnome.splice(pos, 1);
        lista();
    }
    function validacaoEmail(emailInserido) {
        usuario = emailInserido.substring(0, emailInserido.indexOf("@"));
        dominio = emailInserido.substring(emailInserido.indexOf("@")+ 1, emailInserido.length);

        if ((usuario.length >=1) &&
            (dominio.length >=3) &&
            (usuario.search("@")==-1) &&
            (dominio.search("@")==-1) &&
            (usuario.search(" ")==-1) &&
            (dominio.search(" ")==-1) &&
            (dominio.search(".")!=-1) &&
            (dominio.indexOf(".") >=1)&&
            (dominio.lastIndexOf(".") < dominio.length - 1)) {
            return true;
        }else{
            return false;
        }
    }
    function validacaoCampoPreenchido(conteudoCampo){
        return (conteudoCampo.length >=1);
    }
    function validacaoTelefone(numeroTelefone){
        regra = /^[0-9]+$/;
        return (document.getElementById("tel").value.match(regra)); 
    }
    function validacaoCampos() {
        if ((!validacaoCampoPreenchido(document.getElementById("name").value))){
            alert("Nome não foi preenchido.");
            return false;
        } 
        if ((!validacaoCampoPreenchido(document.getElementById("tel").value))){
            alert("Telefone não foi preenchido.");
            return false;
        }
        if ((!validacaoTelefone(document.getElementById("tel").value))){
            alert("Telefone contém caractéres inválidos");
            return false;
        }
        if ((!validacaoEmail(document.getElementById("ema").value))){
            alert("Email inválido")
            return false;
        }
        return true;
    }

    function incluir(){
        if (!validacaoCampos()){
            return;
        }
        vnome.push(new registro());
        document.getElementById("name").value = "";
        document.getElementById("tel").value = "";
        document.getElementById("ema").value = "";
        document.getElementById("name").focus();
        lista();
    }
    function buscar(opcao, busca){
        vnome.sort();
        // verifica se usuário selecionou filtro
        if (opcao == 'Null'){
            alert("É preciso selecionar um filtro.");
            return;
        }
        aux = "";
        x = 0
        for (x=0; x<vnome.length;x++){
            valido = false
            if (opcao == 'nome'){
                valido = (vnome[x].nom.indexOf(busca)==0)
            }
            if (opcao == 'tel'){
                valido = (vnome[x].tel.indexOf(busca)==0)
            }
            if (opcao == 'ema'){
                valido = (vnome[x].ema.indexOf(busca)==0)
            }
            if(valido){
                aux += '<tr><td>' +vnome[x].nom + "</td><td>" +vnome[x].tel +'</td><td>' +vnome[x].ema + '</td><td>' + '<a href="javascript:deletar()"> Excluir</a>' + '</td></tr>';
            }
        }
        rescrever();
    }
    function rescrever(){
        document.getElementById("lista").innerHTML = ['<table border="5px">',
        '<thead bgcolor="gray">',
        '<tr>',
        '<th class="titulo">Nome</th>',
        '<th class="titulo">Telefone</th>',
        '<th class="titulo">E-mail</th>',
        '<th class="titulo">Excluir</th>',
        '</tr>',
        '</thead>',
        '<tbody>',
        aux,
        '</tbody>',
        '</table>'].join("\n")
    }
    </script>
</head>
<body>
<div class="tudo2">
    <form name="frm" id="frm">
        Nome: <br>
        <input type="text" name="nome" id="name" class="barra">
        <select name="filt" class="select">
            <option value="Null">Filtro</option>
            <option value="nome" onselect="n()">Nome</option>
            <option value="tel" >Telefone</option>
            <option value="ema" onselect="e()">Email</option>
        </select>
        <input type="search" name="brrfltr" id="filtro" placeholder="Aperte 'tab' para pesquisar" onblur="buscar(frm.filt.value, frm.brrfltr.value)" class="barraPesquisa">
        <br>
        Telefone:
        <br>
        <input type="tel" name="Telefone" id="tel" class="barra">
        <br>
        E-mail:
        <br>
        <input type="email" name="email" id="ema" placeholder="@" class="barra">
        <br>
        <br>
        <input type="button" value="Inserir" onclick="incluir()" id="insere">
    </form>
</div>
    <div class="tudo">
        Dados Cadastrados: <br>
        <div id="lista"></div>
    </div>
</body>
</html>